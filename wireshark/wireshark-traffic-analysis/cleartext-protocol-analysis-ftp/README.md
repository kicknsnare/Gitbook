# Cleartext Protocol Analysis FTP

## FTP Analysis

File Transfer Protocol (FTP) is designed to transfer files with ease, so it focuses on simplicity rather than security.

FTP analysis in a nutshell:

| Notes                                                                                                                                                                                                                                                    | Wireshark Filter                                                                                                                                                                                                                                               |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Global search                                                                                                                                                                                                                                            | <ul><li><code>ftp</code></li></ul>                                                                                                                                                                                                                             |
| <p>"FTP" options for grabbing the low-hanging fruits:</p><ul><li>x1x series: Information request responses.</li><li>x2x series: Connection messages.</li><li>x3x series: Authentication messages.</li></ul><p>Note: "200" means command successful.</p>  | ---                                                                                                                                                                                                                                                            |
| <p>"x1x" series options for grabbing the low-hanging fruits:</p><ul><li>211: System status.</li><li>212: Directory status.</li><li>213: File status</li></ul>                                                                                            | <ul><li><code>ftp.response.code == 211</code> </li></ul>                                                                                                                                                                                                       |
| <p>"x2x" series options for grabbing the low-hanging fruits:</p><ul><li>220: Service ready.</li><li>227: Entering passive mode.</li><li>228: Long passive mode.</li><li>229: Extended passive mode.</li></ul>                                            | <ul><li><code>ftp.response.code == 227</code></li></ul>                                                                                                                                                                                                        |
| <p>"x3x" series options for grabbing the low-hanging fruits:</p><ul><li>230: User login.</li><li>231: User logout.</li><li>331: Valid username.</li><li>430: Invalid username or password</li><li>530: No login, invalid password.</li></ul>             | <ul><li><code>ftp.response.code == 230</code></li></ul>                                                                                                                                                                                                        |
| <p>"FTP" commands for grabbing the low-hanging fruits:</p><ul><li>USER: Username.</li><li>PASS: Password.</li><li>CWD: Current work directory.</li><li>LIST: List.</li></ul>                                                                             | <ul><li><code>ftp.request.command == "USER"</code></li></ul><ul><li><code>ftp.request.command == "PASS"</code></li></ul><ul><li><code>ftp.request.arg == "password"</code></li></ul>                                                                           |
| <p>Advanced usages examples for grabbing low-hanging fruits:</p><ul><li>Bruteforce signal: List failed login attempts.</li><li>Bruteforce signal: List target username.</li><li>Password spray signal: List targets for a static password.<br></li></ul> | <ul><li><code>ftp.response.code == 530</code></li></ul><ul><li><code>(ftp.response.code == 530) and (ftp.response.arg contains "username")</code></li></ul><ul><li><code>(ftp.request.command == "PASS" ) and (ftp.request.arg == "password")</code></li></ul> |

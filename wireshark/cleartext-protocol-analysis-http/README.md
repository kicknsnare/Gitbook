# Cleartext Protocol Analysis: HTTP



| Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Wireshark Filter                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| <p>Global search</p><p>Note: HTTP2 is a revision of the HTTP protocol for better performance and security. It supports binary data transfer and request&#x26;response multiplexing.</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | <ul><li><code>http</code></li></ul><ul><li><code>http2</code></li></ul>                                                                                                                                                                                                                                                                          |
| <p>"HTTP Request Methods" for grabbing the low-hanging fruits:</p><ul><li>GET</li><li>POST</li><li>Request: Listing all requests</li></ul><p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | <ul><li><code>http.request.method == "GET"</code></li></ul><ul><li><code>http.request.method == "POST"</code></li></ul><ul><li><code>http.request</code></li></ul>                                                                                                                                                                               |
| <p>"HTTP Response Status Codes" for grabbing the low-hanging fruits:</p><ul><li>200 OK: Request successful.</li><li>301 Moved Permanently: Resource is moved to a new URL/path (permanently).</li><li>302 Moved Temporarily: Resource is moved to a new URL/path (temporarily).</li><li>400 Bad Request: Server didn't understand the request.</li><li>401 Unauthorised: URL needs authorisation (login, etc.).</li><li>403 Forbidden: No access to the requested URL. </li><li>404 Not Found: Server can't find the requested URL.</li><li>405 Method Not Allowed: Used method is not suitable or blocked.</li><li>408 Request Timeout:  Request look longer than server wait time.</li><li>500 Internal Server Error: Request not completed, unexpected error.</li><li>503 Service Unavailable: Request not completed server or service is down.</li></ul> | <ul><li><code>http.response.code == 200</code></li></ul><ul><li><code>http.response.code == 401</code></li></ul><ul><li><code>http.response.code == 403</code></li></ul><ul><li><code>http.response.code == 404</code></li></ul><ul><li><code>http.response.code == 405</code></li></ul><ul><li><code>http.response.code == 503</code></li></ul> |
| <p>"HTTP Parameters" for grabbing the low-hanging fruits:</p><ul><li>User agent: Browser and operating system identification to a web server application.</li><li>Request URI: Points the requested resource from the server.<br></li><li>Full *URI: Complete URI information.</li></ul><p>*URI: Uniform Resource Identifier.</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | <ul><li><code>http.user_agent contains "nmap"</code></li></ul><ul><li><code>http.request.uri contains "admin"</code></li></ul><ul><li><code>http.request.full_uri contains "admin"</code></li></ul>                                                                                                                                              |
| <p>"HTTP Parameters" for grabbing the low-hanging fruits:</p><ul><li>Server: Server service name.<br></li><li>Host: Hostname of the server</li><li>Connection: Connection status.<br></li><li>Line-based text data: Cleartext data provided by the server.</li><li>HTML Form URL Encoded: Web form information.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | <ul><li><code>http.server contains "apache"</code></li></ul><ul><li><code>http.host contains "keyword"</code></li></ul><ul><li><code>http.host == "keyword"</code></li></ul><ul><li><code>http.connection == "Keep-Alive"</code></li></ul><ul><li><code>data-text-lines contains "keyword"</code></li></ul>                                      |



## User Agent

| Notes                                                                                                                                                                                                                                                                                                                                                                                                                                       | Wireshark Filter                                                                                                                                                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Global search.                                                                                                                                                                                                                                                                                                                                                                                                                              | <ul><li><code>http.user_agent</code></li></ul>                                                                                                                                      |
| <p>Research outcomes for grabbing the low-hanging fruits:</p><ul><li>Different user agent information from the same host in a short time notice.</li><li>Non-standard and custom user agent info.</li><li>Subtle spelling differences. ("Mozilla" is not the same as  "Mozlilla" or "Mozlila")</li><li>Audit tools info like Nmap, Nikto, Wfuzz and sqlmap in the user agent field.</li><li>Payload data in the user agent field.</li></ul> | <ul><li><code>(http.user_agent contains "sqlmap") or (http.user_agent contains "Nmap") or (http.user_agent contains "Wfuzz") or (http.user_agent contains "Nikto")</code></li></ul> |



## Log4J

Log4j vulnerability analysis in a nutshell:\


| Notes                                                                                                                                                                                               | Wireshark Filters                                                                                                                                                                                                                                                                                                                |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p>Research outcomes for grabbing the low-hanging fruits:</p><ul><li>The attack starts with a "POST" request</li><li>There are known cleartext patterns: "jndi:ldap" and "Exploit.class".</li></ul> | <ul><li><code>http.request.method == "POST"</code></li></ul><ul><li><code>(ip contains "jndi") or ( ip contains "Exploit")</code></li></ul><ul><li><code>(frame contains "jndi") or ( frame contains "Exploit")</code></li></ul><ul><li><code>(http.user_agent contains "$") or (http.user_agent contains "==")</code></li></ul> |

# Malware Hunting with Mark Russinovich and the Sysinternals Tools

{% embed url="https://www.youtube.com/watch?v=vW8eAqZyWeo" %}

## Malware Cleaning Steps

* Disconnect from network
* Identify malicious processes and drivers
* Terminate identified processes
* Identify and delete malware autostarts
* Delete malware files
* Reboot and repeat



## How to indentify Malware processes

&#x20;

<figure><img src="https://camo.githubusercontent.com/2ad791147edae5a76a431f2b0b58690de76a6f22c10e57173314d408ffffdc9e/68747470733a2f2f692e696d6775722e636f6d2f75584e64416b392e706e67" alt=""><figcaption></figcaption></figure>



## Process Explore

if the malware is popping tabs or things use the <mark style="color:blue;">**`window finder`**</mark>

You can do right click + search online to see the process (not much useful anymore)

## Colors

<figure><img src="https://camo.githubusercontent.com/f1d7010ee6ead43d815cd353c6fb72a57303b93bb9cb4a16972c9f1537e24be7/68747470733a2f2f692e696d6775722e636f6d2f42514c776e66482e706e67" alt=""><figcaption></figcaption></figure>

## Signature Verification

<mark style="color:blue;">**`Add a colum for signatures and go to options verify signature images or Doble click into the process -> verify. You will see the signature`**</mark>

<figure><img src="https://camo.githubusercontent.com/d6b61152c3e934db56146bdc08602258af1106f06cc68848f0ca00d10d6c6ce2/68747470733a2f2f692e696d6775722e636f6d2f6d45376d6343412e706e67" alt=""><figcaption></figcaption></figure>



## VirusTotal

Select Columns -> VirusTotal. Options-> VirusTotal.com-> Check VirusTotal.com

## Sigcheck

```powershell
sigcheck -e -u -vr -s c:\
```

## Strings

&#x20;

<figure><img src="https://camo.githubusercontent.com/cd0058791ef545c9f8a68ae2085002460326fe1507415fd446c8d476f24e3e82/68747470733a2f2f692e696d6775722e636f6d2f554f4d4d3542432e706e67" alt=""><figcaption></figcaption></figure>

## The DDL View (CTR+D)

&#x20;

<figure><img src="https://camo.githubusercontent.com/fe96681cb4686a4205208510148e3b3c8ab2b338d056f12c7ba4da741aaba605/68747470733a2f2f692e696d6775722e636f6d2f445461694b4d382e706e67" alt=""><figcaption></figcaption></figure>

## Terminating Malicious Processes

&#x20;

<figure><img src="https://camo.githubusercontent.com/9d1e31e5f177fdb66d9f443fb483a5fe47fb4ab229931506aeea1212c9bb7e94/68747470733a2f2f692e696d6775722e636f6d2f366b34753468622e706e67" alt=""><figcaption></figcaption></figure>

## Cleaning Autostarts

&#x20;

<figure><img src="https://camo.githubusercontent.com/e82ff770e1fa2175485083d0dfbc22620f3035c96d4e266631c6008875e7c1c8/68747470733a2f2f692e696d6775722e636f6d2f75364f737335372e706e67" alt=""><figcaption></figcaption></figure>

## Identifying Malware Autostarts

Uncheck it first to do minimal potential damage in case something bad happened

&#x20;

<figure><img src="https://camo.githubusercontent.com/f4304ebc5b5f5b83c1a01586571e6205140425e14354ab22ec24c9fe3c0a8d76/68747470733a2f2f692e696d6775722e636f6d2f4e3837624276312e706e67" alt=""><figcaption></figcaption></figure>

## Tracing Malware Activity with Process Monitor

<figure><img src="https://camo.githubusercontent.com/10bd72e56ab3c62686abe5828a9e063899534caa02aee7eaefeced32dc5c9fdc/68747470733a2f2f692e696d6775722e636f6d2f68614b69544c4d2e706e67" alt=""><figcaption></figcaption></figure>

Filter->Category -> Write

&#x20;





